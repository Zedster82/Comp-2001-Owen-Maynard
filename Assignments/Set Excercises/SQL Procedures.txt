CREATE PROCEDURE CW1.[Add_User]
@username VARCHAR(50),
@email VARCHAR(80),
@password VARCHAR(40),
@account_type VARCHAR(15)
AS
BEGIN 

INSERT INTO CW1.[User] (username,email,password,account_type)
VALUES
	(@username, @email, @password, @account_type);
END


EXEC CW1.[Add_User] 'Veraint', 'Veraint@students.plymouth.ac.uk', 'testpassword', 'admin'






CREATE PROCEDURE CW1.[Archive_User_Procedure]
@user_id INTEGER
AS
BEGIN


INSERT INTO CW1.[Archive_User] ( username, email, password, account_type)
SELECT username, email, password, account_type
FROM CW1.[User]
WHERE user_id = @user_id;

INSERT INTO CW1.[Archive_Favourite_Activities] (user_id, activity_id)
SELECT * 
FROM CW1.[Favourite_Activities]
WHERE user_id = @user_id;

INSERT INTO CW1.[Archive_Follow_List] (user_id, follow_id)
SELECT * 
FROM CW1.[Follow_List]
WHERE user_id = @user_id;

INSERT INTO CW1.[Archive_Follow_List] (user_id, follow_id)
SELECT * 
FROM CW1.[Follow_List]
WHERE follow_id = @user_id;



DELETE FROM CW1.[Favourite_Activities]
WHERE user_id = @user_id;

DELETE FROM CW1.[Follow_List]
WHERE user_id = @user_id;

DELETE FROM CW1.[Follow_List]
WHERE follow_id = @user_id;

DELETE FROM CW1.[User]
WHERE user_id = @user_id;

END

EXEC CW1.[Archive_User_Procedure] 3






CREATE PROCEDURE CW1.[Un_Archive_User]
@id INTEGER
BEGIN
	//Copy username to main user table
	//Copy email to main user table
	//Copy password to main user table

	//Archive all activity follows
	//Archive all follow records
		
	//Delete username from archive user
	//Delete email from archive user
	//Delete password from archive user
END






CREATE PROCEDURE CW1.[Follow_User]
@user_id INTEGER,
@follow_id INTEGER
AS
BEGIN	

INSERT INTO CW1.[Follow_List] (user_id, follow_id)
VALUES
	(@user_id, @follow_id);
END

EXEC CW1.[Follow_User] 1 , 2






CREATE PROCEDURE CW1.[Unfollow_User]
@user_id INTEGER,
@follow_id INTEGER
AS
BEGIN

DELETE FROM CW1.[Follow_List]
WHERE @user_id = user_id AND @follow_id = follow_id

END

EXEC CW1.[Unfollow_User] 1 , 2





CREATE PROCEDURE CW1.[Favourite_Activity]
@user_id INTEGER,
@activity_id INTEGER
AS
BEGIN

INSERT INTO CW1.[Favourite_Activities] (activity_id, user_id)
VALUES
	(@user_id, @activity_id);
END

EXEC CW1.[Favourite_Activity] 3, 4



CREATE PROCEDURE CW1.[Un_Favourite_Activity]
@user_id INTEGER,
@activity_id INTEGER
AS 
BEGIN

DELETE FROM CW1.[Favourite_Activity]
WHERE @user_id = user_id AND @activity_id = activity_id

END


EXEC CW1.[Un_Favourite_Activity] 3, 4


